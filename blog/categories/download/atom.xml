<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Category: Download | 廣川政樹の開発ブログ - Dolice Lab]]></title>
  <link href="https://lab.dolice.net/blog/categories/download/atom.xml" rel="self"/>
  <link href="https://lab.dolice.net/"/>
  <updated>2020-07-08T13:42:09+09:00</updated>
  <id>https://lab.dolice.net/</id>
  <author>
    <name><![CDATA[Masaki Hirokawa]]></name>
    <email><![CDATA[info@dolice.net]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[アドフリくんバナーを表示する「DCAdfurikunBanner」クラス]]></title>
    <link href="https://lab.dolice.net/blog/2020/07/08/objc-classes-dc-adfurikun-banner/"/>
    <updated>2020-07-08T13:38:00+09:00</updated>
    <id>https://lab.dolice.net/blog/2020/07/08/objc-classes-dc-adfurikun-banner</id>
    <content type="html"><![CDATA[<p>iPhoneアプリに<a href="https://adfurikun.jp/" title="アドフリくん">アドフリくん</a>のモバイルバナー（Ver. 2）を表示する「<a href="https://github.com/masakihirokawa/objc-classes-dc-adfurikun-banner" title="DCAdfurikunBanner">DCAdfurikunBanner</a>」クラスを作成しました。</p>

<p><a href="https://github.com/glossom-dev/AdfurikunSDK-iOS/wiki" title="公式マニュアル">公式マニュアル</a>を参考にさせていただき、10秒毎にバナーがリフレッシュされるよう実装しております。</p>

<p>下記よりサンプルをダウンロード出来ますので、導入の際のお役に立てば幸いです。</p>

<h2>ダウンロード</h2>

<ul>
<li><a href="https://github.com/masakihirokawa/objc-classes-dc-adfurikun-banner">https://github.com/masakihirokawa/objc-classes-dc-adfurikun-banner</a></li>
</ul>


<h2>クラスの使用方法</h2>

<h3>1. バナーの表示</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="p">[[</span><span class="n">DCAdfurikunBanner</span> <span class="n">sharedManager</span><span class="p">]</span> <span class="nl">showAdBanner:</span><span class="n">self</span> <span class="nl">yPos:</span><span class="mf">0.0</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3>2. バナーの削除</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="p">[[</span><span class="n">DCAdfurikunBanner</span> <span class="n">sharedManager</span><span class="p">]</span> <span class="n">removeAdBanner</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3>3. バナーの非表示</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="p">[[</span><span class="n">DCAdfurikunBanner</span> <span class="n">sharedManager</span><span class="p">]</span> <span class="nl">hideAdBanner:</span><span class="n">YES</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3>4. バナーを最前面に配置</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="p">[[</span><span class="n">DCAdfurikunBanner</span> <span class="n">sharedManager</span><span class="p">]</span> <span class="n">insertAdBanner</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3>4. バナーの再読み込み</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="p">[[</span><span class="n">DCAdfurikunBanner</span> <span class="n">sharedManager</span><span class="p">]</span> <span class="n">reloadAdBanner</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>ソースコード</h2>

<h3>DCAdfurikunBanner.h</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">import</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">Foundation</span><span class="o">/</span><span class="n">Foundation</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">import</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">ADFMovieReward</span><span class="o">/</span><span class="n">ADFmyBanner</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@interface</span> <span class="nc">DCAdfurikunBanner</span> : <span class="nc">NSObject</span> <span class="o">&lt;</span><span class="n">ADFmyNativeAdDelegate</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">CGFloat</span> <span class="n">bannerY</span><span class="p">;</span>
</span><span class='line'><span class="kt">BOOL</span>    <span class="n">isAdfurikunFailed</span><span class="p">;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">pragma</span> <span class="n">mark</span> <span class="o">-</span> <span class="n">property</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">)</span> <span class="n">ADFmyBanner</span>              <span class="o">&lt;</span><span class="n">em</span><span class="o">&gt;</span><span class="n">bannerAd</span><span class="p">;</span>
</span><span class='line'><span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">)</span> <span class="n">ADFNativeAdInfo</span>          <span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;</span><span class="n">bannerAdInfo</span><span class="p">;</span>
</span><span class='line'><span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span> <span class="n">strong</span><span class="p">)</span> <span class="n">UIViewController</span> <span class="o">&lt;</span><span class="n">em</span><span class="o">&gt;</span><span class="n">currentRootViewController</span><span class="p">;</span>
</span><span class='line'><span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span> <span class="n">assign</span><span class="p">)</span> <span class="n">NSTimer</span>          <span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;</span><span class="n">refreshTimer</span><span class="p">;</span>
</span><span class='line'><span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span> <span class="n">assign</span><span class="p">)</span> <span class="kt">BOOL</span>             <span class="n">loaded</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">pragma</span> <span class="n">mark</span> <span class="o">-</span> <span class="n">public</span> <span class="n">method</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">ul</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="n">sharedManager</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">showAdBanner:</span><span class="p">(</span><span class="n">UIViewController</span> <span class="o">*</span><span class="p">)</span><span class="n">viewController</span> <span class="nl">yPos:</span><span class="p">(</span><span class="n">CGFloat</span><span class="p">)</span><span class="n">yPos</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">removeAdBanner</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">hideAdBanner:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="n">hidden</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">insertAdBanner</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">reloadAdBanner</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3>DCAdfurikunBanner.m</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">import</span> <span class="s">&quot;DCAdfurikunBanner.h&quot;</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@implementation</span> <span class="nc">DCAdfurikunBanner</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@synthesize</span> <span class="n">bannerAd</span>                  <span class="o">=</span> <span class="o">&lt;</span><span class="n">em</span><span class="o">&gt;</span><span class="n">bannerAd</span><span class="p">;</span>
</span><span class='line'><span class="k">@synthesize</span> <span class="n">bannerAdInfo</span>              <span class="o">=</span> <span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;</span><span class="n">bannerAdInfo</span><span class="p">;</span>
</span><span class='line'><span class="k">@synthesize</span> <span class="n">currentRootViewController</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">em</span><span class="o">&gt;</span><span class="n">currentRootViewController</span><span class="p">;</span>
</span><span class='line'><span class="k">@synthesize</span> <span class="n">refreshTimer</span>              <span class="o">=</span> <span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;</span><span class="n">refreshTimer</span><span class="p">;</span>
</span><span class='line'><span class="k">@synthesize</span> <span class="n">loaded</span>                    <span class="o">=</span> <span class="n">_loaded</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">pragma</span> <span class="n">mark</span> <span class="o">-</span> <span class="n">Shared</span> <span class="n">Manager</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">static</span> <span class="kt">id</span> <span class="n">sharedInstance</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">ul</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="n">sharedManager</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">@synchronized</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">sharedInstance</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">sharedInstance</span> <span class="o">=</span> <span class="p">[[</span><span class="n">self</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="k">return</span> <span class="n">sharedInstance</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">pragma</span> <span class="n">mark</span> <span class="o">-</span> <span class="n">public</span> <span class="n">method</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// バナー表示</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">showAdBanner:</span><span class="p">(</span><span class="n">UIViewController</span> <span class="o">*</span><span class="p">)</span><span class="n">viewController</span> <span class="nl">yPos:</span><span class="p">(</span><span class="n">CGFloat</span><span class="p">)</span><span class="n">yPos</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="p">[</span><span class="n">self</span> <span class="n">removeAdBanner</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">viewController</span> <span class="nl">isEqual:</span><span class="n">self</span><span class="p">.</span><span class="n">currentRootViewController</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">self</span><span class="p">.</span><span class="n">currentRootViewController</span> <span class="o">=</span> <span class="n">viewController</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">bannerY</span> <span class="o">=</span> <span class="n">yPos</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">_bannerAd</span> <span class="o">=</span> <span class="p">[</span><span class="n">ADFmyBanner</span> <span class="nl">createInstance:</span><span class="s">@&quot;広告枠ID&quot;</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">_bannerAd</span> <span class="nl">loadAndNotifyTo:</span><span class="n">self</span><span class="p">];</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// バナー削除</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">removeAdBanner</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">if</span> <span class="p">(</span><span class="n">_bannerAdInfo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">[</span><span class="n">_bannerAdInfo</span><span class="p">.</span><span class="n">mediaView</span> <span class="n">removeFromSuperview</span><span class="p">];</span>
</span><span class='line'>    <span class="n">_bannerAdInfo</span><span class="p">.</span><span class="n">mediaView</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'>    <span class="n">_bannerAdInfo</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">[</span><span class="n">self</span> <span class="n">clearRefreshTimer</span><span class="p">];</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// バナー非表示</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">hideAdBanner:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="n">hidden</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">if</span> <span class="p">(</span><span class="n">_bannerAdInfo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">_bannerAdInfo</span><span class="p">.</span><span class="n">mediaView</span><span class="p">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="n">hidden</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// バナーを最前面に配置</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">insertAdBanner</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">if</span> <span class="p">(</span><span class="n">_bannerAdInfo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">NSUInteger</span> <span class="n">subviewsCount</span> <span class="o">=</span> <span class="p">[[</span><span class="n">self</span><span class="p">.</span><span class="n">currentRootViewController</span><span class="p">.</span><span class="n">view</span> <span class="n">subviews</span><span class="p">]</span> <span class="n">count</span><span class="p">];</span>
</span><span class='line'>    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">currentRootViewController</span><span class="p">.</span><span class="n">view</span> <span class="nl">insertSubview:</span><span class="n">_bannerAdInfo</span><span class="p">.</span><span class="n">mediaView</span> <span class="nl">atIndex:</span><span class="n">subviewsCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// バナーの再読み込み</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">reloadAdBanner</span> <span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">if</span> <span class="p">(</span><span class="n">_bannerAdInfo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">[</span><span class="n">self</span> <span class="n">removeAdBanner</span><span class="p">];</span>
</span><span class='line'>    <span class="p">[</span><span class="n">_bannerAd</span> <span class="nl">loadAndNotifyTo:</span><span class="n">self</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">pragma</span> <span class="n">mark</span> <span class="o">-</span> <span class="n">Refresh</span> <span class="n">Timer</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// 広告の自動更新タイマー開始</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">startRefreshTimer</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">_refreshTimer</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSTimer</span> <span class="nl">scheduledTimerWithTimeInterval:</span><span class="mf">10.0</span> <span class="nl">repeats:</span><span class="n">YES</span> <span class="nl">block:</span><span class="o">^</span><span class="p">(</span><span class="n">NSTimer</span> <span class="o">*</span> <span class="n">_Nonnull</span> <span class="n">timer</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">[</span><span class="n">self</span> <span class="n">reloadAdBanner</span><span class="p">];</span>
</span><span class='line'><span class="p">}];</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// 広告の自動更新タイマー削除</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">clearRefreshTimer</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">if</span> <span class="p">(</span><span class="n">_refreshTimer</span> <span class="o">!=</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">[</span><span class="n">_refreshTimer</span> <span class="n">invalidate</span><span class="p">];</span>
</span><span class='line'>    <span class="n">_refreshTimer</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">pragma</span> <span class="n">mark</span> <span class="o">-</span> <span class="n">delegate</span> <span class="n">method</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// バナーの取得に成功した時に呼ばれる</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">onNativeAdLoadFinish:</span><span class="p">(</span><span class="n">ADFNativeAdInfo</span> <span class="o">&lt;</span><span class="n">em</span><span class="o">&gt;</span><span class="p">)</span><span class="n">info</span> <span class="nl">appID:</span><span class="p">(</span><span class="n">NSString</span> <span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;</span><span class="p">)</span><span class="n">appID</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="c1">//NSLog(@&quot;onNativeAdLoadFinish&quot;);</span>
</span><span class='line'>
</span><span class='line'><span class="n">_bannerAdInfo</span> <span class="o">=</span> <span class="n">info</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">CGFloat</span> <span class="k">const</span> <span class="n">bannerWidth</span>  <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">currentRootViewController</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">;</span>
</span><span class='line'><span class="n">CGFloat</span> <span class="k">const</span> <span class="n">bannerHeight</span> <span class="o">=</span> <span class="mf">50.0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">_bannerAdInfo</span><span class="p">.</span><span class="n">mediaView</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bannerY</span><span class="p">,</span> <span class="n">bannerWidth</span><span class="p">,</span> <span class="n">bannerHeight</span><span class="p">);</span>
</span><span class='line'><span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">currentRootViewController</span><span class="p">.</span><span class="n">view</span> <span class="nl">addSubview:</span><span class="n">_bannerAdInfo</span><span class="p">.</span><span class="n">mediaView</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">_bannerAdInfo</span> <span class="n">playMediaView</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="p">[</span><span class="n">self</span> <span class="n">clearRefreshTimer</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">self</span> <span class="n">startRefreshTimer</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="n">_loaded</span> <span class="o">=</span> <span class="n">YES</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">isAdfurikunFailed</span> <span class="o">=</span> <span class="o">!</span><span class="n">_loaded</span><span class="p">;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// バナーの取得に失敗した時に呼ばれる</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">onNativeAdLoadError:</span><span class="p">(</span><span class="n">ADFMovieError</span> <span class="o">&lt;</span><span class="n">em</span><span class="o">&gt;</span><span class="p">)</span><span class="n">error</span> <span class="nl">appID:</span><span class="p">(</span><span class="n">NSString</span> <span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;</span><span class="p">)</span><span class="n">appID</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="c1">//NSLog(@&quot;Failed to load native ad, error code=%lu, error message=\&quot;%@\&quot;&quot;, (unsigned long)error.errorCode, error.errorMessage);</span>
</span><span class='line'>
</span><span class='line'><span class="n">_loaded</span> <span class="o">=</span> <span class="n">NO</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">isAdfurikunFailed</span> <span class="o">=</span> <span class="o">!</span><span class="n">_loaded</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// バナー再読み込み</span>
</span><span class='line'><span class="p">[</span><span class="n">self</span> <span class="nl">showAdBanner:</span><span class="n">self</span><span class="p">.</span><span class="n">currentRootViewController</span> <span class="nl">yPos:</span><span class="n">bannerY</span><span class="p">];</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[AdMobの GDPR対応（iOS）]]></title>
    <link href="https://lab.dolice.net/blog/2018/06/03/objc-personalized-ad-consent/"/>
    <updated>2018-06-03T08:02:00+09:00</updated>
    <id>https://lab.dolice.net/blog/2018/06/03/objc-personalized-ad-consent</id>
    <content type="html"><![CDATA[<p>AdMobを使用した iOSアプリで GDPRに対応した同意フォームを表示するサンプルを作成しました。</p>

<p>主に<a href="https://developers.google.com/admob/ios/eu-consent" title="公式ドキュメント">公式ドキュメント</a>の情報を参考にしています。</p>

<h2>サンプルダウンロード</h2>

<ul>
<li><a href="https://github.com/masakihirokawa/objc-personalized-ad-consent">https://github.com/masakihirokawa/objc-personalized-ad-consent</a></li>
</ul>


<h2>導入準備</h2>

<h3>1. 広告技術プロバイダの選択</h3>

<p>AdMobの管理画面にログインし、「ブロックの管理」→「EU ユーザーの同意」画面を開きます。</p>

<p>次に『広告技術プロバイダの選択』から『広告技術プロバイダのカスタム グループ』を選択します（この設定の反映には、自分の場合は1時間ほど要しました。反映されるまで同意フォームの読み込みエラーが発生しますので、気長に待ちましょう）。</p>

<p>また、『同意取得の設定』にある『サイト運営者 ID』も後に使用するので控えておきます。</p>

<h3>2. CocoaPodsから SDKをインストール</h3>

<p><em>Podfile</em>に「<em>pod 'PersonalizedAdConsent'</em>」の一行を追加し、SDKをインストールします。</p>

<h2>実装</h2>

<h3>同意フォームの表示</h3>

<p>EU圏内であれば同意フォームを表示し、従来通りのパーソナライズされた広告を表示するか、非パーソナライズされた広告を表示するかの設定を保持し、その設定によって広告のリクエストを分岐します。</p>

<h4>ViewController.h</h4>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">import</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">UIKit</span><span class="o">/</span><span class="n">UIKit</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">import</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">PersonalizedAdConsent</span><span class="o">/</span><span class="n">PersonalizedAdConsent</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">import</span> <span class="s">&quot;Common.h&quot;</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@interface</span> <span class="nc">ViewController</span> : <span class="nc">UIViewController</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h4>ViewController.m</h4>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">import</span> <span class="s">&quot;ViewController.h&quot;</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@interface</span> <span class="nc">ViewController</span> <span class="p">()</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@end</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@implementation</span> <span class="nc">ViewController</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">NSString</span> <span class="o">&lt;</span><span class="n">em</span><span class="o">&gt;</span><span class="k">const</span> <span class="n">ADMOB_PUB_ID</span>       <span class="o">=</span> <span class="s">@&quot;Your AdMob Publisher ID&quot;</span><span class="p">;</span> <span class="c1">// AdMobのパブリッシャーID</span>
</span><span class='line'><span class="n">NSString</span> <span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;</span><span class="k">const</span> <span class="n">PRIVACY_POLICY_URL</span> <span class="o">=</span> <span class="s">@&quot;Your Privacy Policy URL&quot;</span><span class="p">;</span> <span class="c1">// プライバシーポリシーURL</span>
</span><span class='line'><span class="kt">BOOL</span>      <span class="k">const</span> <span class="n">PAC_DEBUG_MODE</span>     <span class="o">=</span> <span class="n">YES</span><span class="p">;</span> <span class="c1">// デバッグモード&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">pragma</span> <span class="n">mark</span> <span class="o">-&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">ul</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLoad</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="p">[</span><span class="n">super</span> <span class="n">viewDidLoad</span><span class="p">];</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="c1">// 広告のパーソナライズ設定</span>
</span><span class='line'>  <span class="p">[</span><span class="n">self</span> <span class="n">initPersonalizedAdsSetting</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">pragma</span> <span class="n">mark</span> <span class="o">-</span> <span class="n">Personalized</span> <span class="n">Ads</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// 広告のパーソナライズ設定</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">initPersonalizedAdsSetting</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="c1">// デバッグ用</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">PAC_DEBUG_MODE</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// 実機の識別子をコンソール表示</span>
</span><span class='line'>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Advertising ID: %@&quot;</span><span class="p">,</span> <span class="n">ASIdentifierManager</span><span class="p">.</span><span class="n">sharedManager</span><span class="p">.</span><span class="n">advertisingIdentifier</span><span class="p">.</span><span class="n">UUIDString</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 上記で出力した実機の識別子を入力（シミュレータで確認する場合は不要）</span>
</span><span class='line'>    <span class="n">PACConsentInformation</span><span class="p">.</span><span class="n">sharedInstance</span><span class="p">.</span><span class="n">debugIdentifiers</span> <span class="o">=</span> <span class="err">@</span><span class="p">[</span><span class="s">@&quot;Advertising ID&quot;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// ユーザー地域をEU圏内に指定</span>
</span><span class='line'>    <span class="n">PACConsentInformation</span><span class="p">.</span><span class="n">sharedInstance</span><span class="p">.</span><span class="n">debugGeography</span> <span class="o">=</span> <span class="n">PACDebugGeographyEEA</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// ユーザー地域をEU圏外に指定</span>
</span><span class='line'>    <span class="c1">//PACConsentInformation.sharedInstance.debugGeography = PACDebugGeographyNotEEA;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 広告のパーソナライズ設定初期化</span>
</span><span class='line'><span class="p">[[</span><span class="n">Common</span> <span class="n">sharedManager</span><span class="p">]</span> <span class="n">initPersonalizedAdsSetting</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// ユーザー情報をリクエスト</span>
</span><span class='line'><span class="p">[</span><span class="n">PACConsentInformation</span><span class="p">.</span><span class="n">sharedInstance</span>
</span><span class='line'> <span class="nl">requestConsentInfoUpdateForPublisherIdentifiers:</span><span class="err">@</span><span class="p">[</span><span class="n">ADMOB_PUB_ID</span><span class="p">]</span>
</span><span class='line'> <span class="nl">completionHandler:</span><span class="o">^</span><span class="p">(</span><span class="n">NSError</span> <span class="o">*</span><span class="n">_Nullable</span> <span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>     <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>         <span class="c1">// エラー</span>
</span><span class='line'>         <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Error -&amp;gt; requestConsentInfoUpdate: %@&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
</span><span class='line'>     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>         <span class="k">if</span> <span class="p">([</span><span class="n">PACConsentInformation</span> <span class="n">sharedInstance</span><span class="p">].</span><span class="n">isRequestLocationInEEAOrUnknown</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>             <span class="c1">// EU圏内もしくは不明であればステータスをチェックする</span>
</span><span class='line'>             <span class="n">NSUInteger</span> <span class="k">const</span> <span class="n">status</span> <span class="o">=</span> <span class="n">PACConsentInformation</span><span class="p">.</span><span class="n">sharedInstance</span><span class="p">.</span><span class="n">consentStatus</span><span class="p">;</span>
</span><span class='line'>             <span class="k">switch</span> <span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                 <span class="k">case</span> <span class="nl">PACConsentStatusPersonalized:</span>
</span><span class='line'>                 <span class="k">case</span> <span class="nl">PACConsentStatusNonPersonalized:</span>
</span><span class='line'>                     <span class="c1">// TODO: 既に同意フォームから設定を保存済みなので、保存済みのパーソナライズ設定の広告を表示</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>                     <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                 <span class="k">case</span> <span class="nl">PACConsentStatusUnknown:</span>
</span><span class='line'>                 <span class="k">default</span><span class="o">:</span>
</span><span class='line'>                     <span class="c1">// 同意情報をユーザーから取得する必要があるので同意フォームを表示する</span>
</span><span class='line'>                     <span class="p">[</span><span class="n">self</span> <span class="n">showConsentForm</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>                     <span class="k">break</span><span class="p">;</span>
</span><span class='line'>             <span class="p">}</span>
</span><span class='line'>         <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>             <span class="c1">// TODO: EU圏外であれば従来通りパーソナライズされた広告を表示</span>
</span><span class='line'>
</span><span class='line'>         <span class="p">}</span>
</span><span class='line'>     <span class="p">}</span>
</span><span class='line'> <span class="p">}];</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// 同意フォームの表示</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">showConsentForm</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="c1">// プライバシーポリシーURLを指定し同意フォーム初期化</span>
</span><span class='line'><span class="n">NSURL</span> <span class="o">*</span><span class="n">privacyURL</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSURL</span> <span class="nl">URLWithString:</span><span class="n">PRIVACY_POLICY_URL</span><span class="p">];</span>
</span><span class='line'><span class="n">PACConsentForm</span> <span class="o">*</span><span class="n">form</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PACConsentForm</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithApplicationPrivacyPolicyURL:</span><span class="n">privacyURL</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// パーソナライズ広告の同意ボタンの有無</span>
</span><span class='line'><span class="n">form</span><span class="p">.</span><span class="n">shouldOfferPersonalizedAds</span> <span class="o">=</span> <span class="n">YES</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// パーソナライズされていない広告の同意ボタンの有無</span>
</span><span class='line'><span class="n">form</span><span class="p">.</span><span class="n">shouldOfferNonPersonalizedAds</span> <span class="o">=</span> <span class="n">YES</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 有料アプリへの誘導ボタンの有無</span>
</span><span class='line'><span class="n">form</span><span class="p">.</span><span class="n">shouldOfferAdFree</span> <span class="o">=</span> <span class="n">NO</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 同意フォームの読み込み</span>
</span><span class='line'><span class="p">[</span><span class="n">form</span> <span class="nl">loadWithCompletionHandler:</span><span class="o">^</span><span class="p">(</span><span class="n">NSError</span> <span class="o">*</span><span class="n">_Nullable</span> <span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ロードエラー</span>
</span><span class='line'>        <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Error -&amp;gt; loadWithCompletionHandler: %@&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ロード成功</span>
</span><span class='line'>        <span class="p">[</span><span class="n">form</span> <span class="nl">presentFromViewController:</span><span class="n">self</span>
</span><span class='line'>                      <span class="nl">dismissCompletion:</span><span class="o">^</span><span class="p">(</span><span class="n">NSError</span> <span class="o">*</span><span class="n">_Nullable</span> <span class="n">error</span><span class="p">,</span> <span class="kt">BOOL</span> <span class="n">userPrefersAdFree</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                              <span class="c1">// エラー</span>
</span><span class='line'>                              <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Error -&amp;gt; presentFromViewController: %@&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
</span><span class='line'>                          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                              <span class="c1">// ユーザーが同意フォームのどれを選択したかによって処理を分岐</span>
</span><span class='line'>                              <span class="c1">//PACConsentStatus *status = PACConsentInformation.sharedInstance.consentStatus; // 左記では型指定の警告が発生</span>
</span><span class='line'>                              <span class="n">NSUInteger</span> <span class="k">const</span> <span class="n">status</span> <span class="o">=</span> <span class="n">PACConsentInformation</span><span class="p">.</span><span class="n">sharedInstance</span><span class="p">.</span><span class="n">consentStatus</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>                              <span class="k">switch</span> <span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                                  <span class="k">case</span> <span class="nl">PACConsentStatusPersonalized:</span>
</span><span class='line'>                                      <span class="c1">// パーソナライズ広告を表示するよう設定</span>
</span><span class='line'>                                      <span class="p">[[</span><span class="n">Common</span> <span class="n">sharedManager</span><span class="p">]</span> <span class="nl">setPersonalizedAdsSetting:</span><span class="n">YES</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>                                      <span class="c1">// TODO: 広告の読み込み</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>                                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                                  <span class="k">case</span> <span class="nl">PACConsentStatusNonPersonalized:</span>
</span><span class='line'>                                      <span class="c1">// パーソナライズされていない広告を表示するよう設定</span>
</span><span class='line'>                                      <span class="p">[[</span><span class="n">Common</span> <span class="n">sharedManager</span><span class="p">]</span> <span class="nl">setPersonalizedAdsSetting:</span><span class="n">NO</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>                                      <span class="c1">// TODO: 広告の読み込み</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>                                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                                  <span class="k">case</span> <span class="nl">PACConsentStatusUnknown:</span>
</span><span class='line'>                                  <span class="k">default</span><span class="o">:</span>
</span><span class='line'>                                      <span class="c1">// 同意が得られなかった場合の処理（通常は何もしない）</span>
</span><span class='line'>
</span><span class='line'>                                      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>                              <span class="p">}</span>
</span><span class='line'>                          <span class="p">}</span>
</span><span class='line'>                      <span class="p">}];</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}];</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3>広告のパーソナライズ設定の保持</h3>

<p>広告のパーソナライズ設定をユーザーデフォルトに保持します。</p>

<h4>Common.h</h4>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">import</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">UIKit</span><span class="o">/</span><span class="n">UIKit</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">import</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">PersonalizedAdConsent</span><span class="o">/</span><span class="n">PersonalizedAdConsent</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">define</span> <span class="n">UD_PERSONALIZED_ADS_KEY</span> <span class="s">@&quot;UD_PERSONALIZED_ADS_KEY&quot;</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@interface</span> <span class="nc">Common</span> : <span class="nc">UIView</span> <span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">NSUserDefaults</span> <span class="o">*</span><span class="n">userDefaults</span><span class="p">;</span>
</span><span class='line'><span class="kt">BOOL</span>           <span class="n">usePersonalizedAds</span><span class="p">;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">pragma</span> <span class="n">mark</span> <span class="o">-</span> <span class="n">property</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span> <span class="n">retain</span><span class="p">)</span> <span class="n">NSUserDefaults</span> <span class="o">*</span><span class="n">userDefaults</span><span class="p">;</span>
</span><span class='line'><span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span> <span class="n">assign</span><span class="p">)</span> <span class="kt">BOOL</span>           <span class="n">usePersonalizedAds</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">pragma</span> <span class="n">mark</span> <span class="o">-</span> <span class="n">public</span> <span class="n">method</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">ul</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Common</span> <span class="o">*</span><span class="p">)</span><span class="n">sharedManager</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">setPersonalizedAdsSetting:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="n">usePersonalizedAds</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="n">isRequestLocationInEEAOrUnknown</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">initPersonalizedAdsSetting</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h4>Common.m</h4>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">import</span> <span class="s">&quot;Common.h&quot;</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@implementation</span> <span class="nc">Common</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@synthesize</span> <span class="n">userDefaults</span><span class="p">;</span>
</span><span class='line'><span class="k">@synthesize</span> <span class="n">usePersonalizedAds</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">pragma</span> <span class="n">mark</span> <span class="o">-</span> <span class="n">Shared</span> <span class="n">Manager</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">static</span> <span class="n">Common</span> <span class="o">*</span><span class="n">_sharedInstance</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">ul</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Common</span> <span class="o">*</span><span class="p">)</span><span class="n">sharedManager</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">_sharedInstance</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span>  <span class="n">_sharedInstance</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Common</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="k">return</span> <span class="n">_sharedInstance</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">pragma</span> <span class="n">mark</span> <span class="o">-</span> <span class="n">Personalized</span> <span class="n">Ads</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// 広告のパーソナライズ設定初期化</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">initPersonalizedAdsSetting</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="c1">// ユーザーデフォルト初期化</span>
</span><span class='line'><span class="n">NSMutableDictionary</span> <span class="o">*</span><span class="n">personalizedAdsDefaults</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSMutableDictionary</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">personalizedAdsDefaults</span> <span class="nl">setValue:</span><span class="err">@</span><span class="n">YES</span> <span class="nl">forKey:</span><span class="n">UD_PERSONALIZED_ADS_KEY</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">Common</span> <span class="n">sharedManager</span><span class="p">].</span><span class="n">userDefaults</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSUserDefaults</span> <span class="n">standardUserDefaults</span><span class="p">];</span>
</span><span class='line'><span class="p">[[</span><span class="n">Common</span> <span class="n">sharedManager</span><span class="p">].</span><span class="n">userDefaults</span> <span class="nl">registerDefaults:</span><span class="n">personalizedAdsDefaults</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 広告のパーソナライズ設定をユーザーデフォルトから保持</span>
</span><span class='line'><span class="p">[</span><span class="n">Common</span> <span class="n">sharedManager</span><span class="p">].</span><span class="n">usePersonalizedAds</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Common</span> <span class="n">sharedManager</span><span class="p">].</span><span class="n">userDefaults</span> <span class="nl">boolForKey:</span><span class="n">UD_PERSONALIZED_ADS_KEY</span><span class="p">];</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// 広告のパーソナライズ設定保持</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">setPersonalizedAdsSetting:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="n">usePersonalizedAds</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="c1">// 広告のパーソナライズ設定保持</span>
</span><span class='line'><span class="p">[</span><span class="n">Common</span> <span class="n">sharedManager</span><span class="p">].</span><span class="n">usePersonalizedAds</span> <span class="o">=</span> <span class="n">usePersonalizedAds</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// ユーザーデフォルト更新</span>
</span><span class='line'><span class="p">[[</span><span class="n">Common</span> <span class="n">sharedManager</span><span class="p">].</span><span class="n">userDefaults</span> <span class="nl">setBool:</span><span class="p">[</span><span class="n">Common</span> <span class="n">sharedManager</span><span class="p">].</span><span class="n">usePersonalizedAds</span> <span class="nl">forKey:</span><span class="n">UD_PERSONALIZED_ADS_KEY</span><span class="p">];</span>
</span><span class='line'><span class="p">[[</span><span class="n">Common</span> <span class="n">sharedManager</span><span class="p">].</span><span class="n">userDefaults</span> <span class="n">synchronize</span><span class="p">];</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">// ユーザー地域がEEAまたは不明であるか取得</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="n">isRequestLocationInEEAOrUnknown</span>
</span><span class='line'><span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="k">return</span> <span class="p">[</span><span class="n">PACConsentInformation</span> <span class="n">sharedInstance</span><span class="p">].</span><span class="n">isRequestLocationInEEAOrUnknown</span><span class="p">;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3>非パーソナライズ広告のリクエスト</h3>

<p>非パーソナライズ広告を表示する場合は、下記のように広告のリクエスト時にパラメータを渡します。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">GADRequest</span> <span class="o">*</span><span class="n">request</span> <span class="o">=</span> <span class="p">[</span><span class="n">GADRequest</span> <span class="n">request</span><span class="p">];</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">Common</span> <span class="n">sharedManager</span><span class="p">].</span><span class="n">usePersonalizedAds</span><span class="p">)</span> <span class="p">{</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">GADExtras</span> <span class="o">*</span><span class="n">extras</span> <span class="o">=</span> <span class="p">[[</span><span class="n">GADExtras</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'><span class="n">extras</span><span class="p">.</span><span class="n">additionalParameters</span> <span class="o">=</span> <span class="err">@</span><span class="p">{</span><span class="s">@&quot;npa&quot;</span><span class="o">:</span> <span class="s">@&quot;1&quot;</span><span class="p">};</span>
</span><span class='line'><span class="p">[</span><span class="n">request</span> <span class="nl">registerAdNetworkExtras:</span><span class="n">extras</span><span class="p">];</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>以上が導入から実装までの大まかな流れになります。</p>

<p>EU圏内からのアプリ使用で、同意フォームを表示する場合はまだ広告を表示しないようにし、選択された内容によって従来通りのパーソナライズされた広告か、非パーソナライズされた広告を読み込むのが良いと思います。</p>

<p>また、アプリのどこかに同意フォームを再表示できるメニューやボタンを用意し、ユーザーがいつでも設定を変更できる必要があります。</p>

<p>大雑把な情報ではありますが、少しでもお役に立てば幸いです。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iPhoneアプリ「リラックス・ヒーリング」アップデート（3.0.0）]]></title>
    <link href="https://lab.dolice.net/blog/2018/03/01/ios-relaxing-healing-update-3-0-0/"/>
    <updated>2018-03-01T08:56:00+09:00</updated>
    <id>https://lab.dolice.net/blog/2018/03/01/ios-relaxing-healing-update-3-0-0</id>
    <content type="html"><![CDATA[<p>ヒーリング音楽や睡眠に効果的なサウンドを聴いてリラックスできる iPhoneアプリ「<a href="https://itunes.apple.com/us/app/hearing-healing/id694492667?mt=8" title="リラックス・ヒーリング">リラックス・ヒーリング</a>」をアップデートいたしました。</p>

<p>今回のアップデートでは、デザイン（色合い）を大幅に改訂し、ミュージックのオフタイマー機能やミュージックコントロール機能の追加などを行いました。よりリラックスできる優しい配色を心掛け、快適にご利用いただけるよう配慮いたしました。</p>

<p>下記よりアプリをダウンロードできますので、是非ご利用ください。</p>

<p><a href="https://itunes.apple.com/jp/app/%E3%83%AA%E3%83%A9%E3%83%83%E3%82%AF%E3%82%B9-%E3%83%92%E3%83%BC%E3%83%AA%E3%83%B3%E3%82%B0-%E5%BF%83%E5%9C%B0%E8%89%AF%E3%81%84%E7%9D%A1%E7%9C%A0%E3%82%B5%E3%82%A6%E3%83%B3%E3%83%89/id694492667?mt=8" style="display:inline-block;overflow:hidden;background:url(https://linkmaker.itunes.apple.com/assets/shared/badges/ja-jp/appstore-lrg.svg) no-repeat;width:135px;height:40px;background-size:contain;"></a></p>

<h2>このアプリについて</h2>

<p>α波発生に効果的なヒーリング音楽、雨音や森の中の小鳥のさえずりなどのサウンドを聴きながら、リラックスして深い眠りに就くことができます。</p>

<p>ストレスの軽減や寝付きが悪い時の対策、そして心身の疲れに効果があります。</p>

<p>ホワイトノイズも収録していますので、仕事や勉強に打ち込む時の作業用BGMにもお薦めです。</p>

<p><img src="/images/article/relaxing_healing_3_0_0/relaxing_healing_screenshot1.jpg" title="ミュージック画面" alt="ミュージック画面" /></p>

<p>5曲のヒーリング音楽を収録しています。全曲連続で再生したり、一曲リピートさせることもできます。現在、約1時間分のヒーリング音楽を収録しています。</p>

<p>バックグラウンド再生もサポートしていますので、他のアプリを操作しながらでも音楽をお楽しみいただけます。</p>

<p><img src="/images/article/relaxing_healing_3_0_0/relaxing_healing_screenshot2.jpg" title="サウンド画面" alt="サウンド画面" /></p>

<p>雨音などの環境音は11種収録しています。設定した時間が来ると徐々に音量を下げながら停止しますので、睡眠の妨げにはなりません。</p>

<p>眠る前に、例えば小川のせせらぎなどを流したまま、リラックスした頃に知らず知らずと心地良い睡眠に入ることができます。</p>

<p><img src="/images/article/relaxing_healing_3_0_0/relaxing_healing_screenshot3.jpg" title="アラーム画面" alt="アラーム画面" /></p>

<p>目覚まし機能も搭載しており、5種類のアラーム音から選んで使用できます。音楽やサウンドを流したままアラームを設定しても、起床時刻と同時に停止するので安心です。</p>

<p><img src="/images/article/relaxing_healing_3_0_0/relaxing_healing_screenshot4.jpg" title="設定画面" alt="設定画面" /></p>

<p>設定画面では、ミュージック／サウンド／アラームの音量変更や、ミュージックのリピート設定と再生時間設定、サウンドの再生時間設定などが行えます。</p>

<h2>収録内容</h2>

<h3>ヒーリング音楽</h3>

<p>ヒーリング音楽は下記の5曲を収録しています（4曲目と5曲目は、アプリ内から購入いただくと聴く事ができます）。</p>

<ol>
<li>ストレス解消ヒーリング音楽（α波）[10:25]</li>
<li>神秘的なヒーリング音楽 [16:51]</li>
<li>快適な眠りを誘う癒しの音楽（α波）[15:31]</li>
<li>体に優しい癒しの音楽（有料） [06:34]</li>
<li>さざなみヒーリング音楽（有料） [09:47]</li>
</ol>


<h3>サウンド</h3>

<p>サウンドは下記の11項目を全て無料でお聞きいただけます。</p>

<ol>
<li>雨音と川のせせらぎ</li>
<li>夕立の雨音</li>
<li>雰囲気に満ちた豪雨の音</li>
<li>雨とカエルの鳴き声</li>
<li>ルイジアナの雨音</li>
<li>鳥の鳴き声</li>
<li>雪解け水の音</li>
<li>波の音</li>
<li>ホワイトノイズ</li>
<li>森林浴</li>
<li>フクロウの鳴き声</li>
</ol>


<h3>アラーム音</h3>

<p>アラーム音は下記から好きな音を選択できます。</p>

<ol>
<li>アナログ目覚まし時計</li>
<li>デジタル目覚まし時計</li>
<li>目覚ましベル</li>
<li>ビープ音</li>
<li>警報音</li>
</ol>


<h2>主な機能</h2>

<ul>
<li>ヒーリングミュージック再生機能（5曲）</li>
<li>ヒーリングミュージックのオールプレイ機能</li>
<li>雨音や環境音の再生機能（11サウンド）</li>
<li>目覚まし機能（5種のアラーム音を搭載）</li>
</ul>


<h2>価格</h2>

<ul>
<li>無料（App内購入あり）</li>
</ul>


<h2>対応言語</h2>

<ul>
<li>日本語</li>
<li>英語</li>
</ul>


<h2>Facebook公式ページ</h2>

<ul>
<li><a href="https://www.facebook.com/dolice.hearing.healing">https://www.facebook.com/dolice.hearing.healing</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iPhone/Androidアプリ「浮世絵壁紙 - 美しい日本画ギャラリー」アップデート]]></title>
    <link href="https://lab.dolice.net/blog/2018/01/19/ios-android-ukiyo-e-update/"/>
    <updated>2018-01-19T10:11:00+09:00</updated>
    <id>https://lab.dolice.net/blog/2018/01/19/ios-android-ukiyo-e-update</id>
    <content type="html"><![CDATA[<div class="app_screenshot_container"><img src="https://dolice.net/mb/ios/marketing/images/ukiyo-e/screenshot_pc/ja/screenshot1.jpg" class="app_screenshot" /></div>


<p>「浮世絵壁紙 - 美しい日本画ギャラリー」iPhone/Android版をアップデートいたしました。</p>

<p>今回のアップデートでは、新たに12名の作者別カテゴリを追加し、デザインのブラッシュアップを行いました。多くの方々により長くお楽しみいただけるよう、今後も定期的に更新を続けて参ります。</p>

<p>下記よりアプリをダウンロードできますので、是非ご利用ください。</p>

<p><a href="https://itunes.apple.com/jp/app/%E6%B5%AE%E4%B8%96%E7%B5%B5%E5%A3%81%E7%B4%99-%E7%BE%8E%E3%81%97%E3%81%84%E6%97%A5%E6%9C%AC%E7%94%BB%E3%82%AE%E3%83%A3%E3%83%A9%E3%83%AA%E3%83%BC-iphone-6-6-plus-5-ipod%E5%AF%BE%E5%BF%9C/id835559799?mt=8" style="display:inline-block;overflow:hidden;background:url(//linkmaker.itunes.apple.com/assets/shared/badges/ja-jp/appstore-lrg.svg) no-repeat;width:135px;height:40px;background-size:contain;margin:7px 0 -9px 10px;"></a></p>

<p><a href='https://play.google.com/store/apps/details?id=net.dolice.ukiyoe&pcampaignid=MKT-Other-global-all-co-prtnr-py-PartBadge-Mar2515-1'><img src='https://play.google.com/intl/ja/badges/images/generic/ja_badge_web_generic.png' style="width: 155px;" /></a></p>

<h2>新たに追加したカテゴリ</h2>

<h3>作者別</h3>

<ul>
<li>歌川国政</li>
<li>歌川房種</li>
<li>歌川国利</li>
<li>歌川芳豊</li>
<li>笠松紫浪</li>
<li>吉田博</li>
<li>伊東深水</li>
<li>小原古邨</li>
<li>長谷川貞信（三代）</li>
<li>鳥居言人</li>
<li>名取春仙</li>
<li>山本昇雲</li>
</ul>


<h2>価格</h2>

<ul>
<li>無料</li>
</ul>


<h2>対応言語</h2>

<ul>
<li>日本語</li>
<li>英語</li>
<li>ロシア語</li>
<li>フランス語</li>
<li>イタリア語</li>
<li>タイ語（Android版のみ）</li>
<li>繁体中国語</li>
</ul>


<h2>著作権表記</h2>

<p>浮世絵は著作権フリー（著作権切れ）の作品のみを選別し、iPhone/Android用の壁紙、または作品集として一枚ずつ丹念に加工・修復しています。</p>

<h2>公式Facebookページ</h2>

<ul>
<li><a href="https://www.facebook.com/dolice.ukiyoe.ja">https://www.facebook.com/dolice.ukiyoe.ja</a></li>
</ul>


<h2>関連記事</h2>

<ul>
<li><strong><a href="/blog/2014/10/24/ios-ukiyo-e-ja/" title="浮世絵壁紙 - 美しい日本画ギャラリー - iPhone/iPodアプリ">浮世絵壁紙 - 美しい日本画ギャラリー - iPhone/iPodアプリ</a></strong></li>
<li><strong><a href="/blog/2014/10/24/ios-ukiyo-e-ja/" title="Androidアプリ「浮世絵壁紙 - 美しい日本画ギャラリー」リリース">Androidアプリ「浮世絵壁紙 - 美しい日本画ギャラリー」リリース</a></strong></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iPhoneアプリ「望みが叶う！引き寄せの法則アプリ」アップデート（1.4.0）]]></title>
    <link href="https://lab.dolice.net/blog/2018/01/06/ios-law-of-attraction-update-1-4-0/"/>
    <updated>2018-01-06T10:14:00+09:00</updated>
    <id>https://lab.dolice.net/blog/2018/01/06/ios-law-of-attraction-update-1-4-0</id>
    <content type="html"><![CDATA[<p><img src="/images/article/law_of_attraction.jpg" title="iPhone App: 望みが叶う！引き寄せの法則アプリ" alt="iPhone App: 望みが叶う！引き寄せの法則アプリ" /></p>

<p>引き寄せの法則を簡単に実践できる iPhoneアプリ「<a href="https://itunes.apple.com/us/app/law-of-attraction-free/id841157677?mt=8" title="望みが叶う！引き寄せの法則アプリ">望みが叶う！引き寄せの法則アプリ</a>」をアップデートしました。</p>

<p>今回のアップデートでは、ご要望の多かった Touch ID / Face IDへの対応および、iPhone Xへの対応を行いました。また、ユーザーの方々よりご報告いただいた幾つかの不具合を修正いたしました。</p>

<p>現在のバージョンから「望み」編集時の文字数制限を廃止し、改行を連続して入力できるよう仕様を変更しております。これにより、より自由な編集が行えるようになりました。</p>

<p>ユーザーの方々から寄せられたご要望はまだ全て反映できておりませんが、今後も丁寧にアップデートを重ねて行きたく思います。</p>

<p>いつも当アプリをご利用いただき、本当にありがとうございます。</p>

<h2>更新内容</h2>

<ol>
<li>Touch ID / Face IDに対応いたしました</li>
<li>「望み」作成時の文字数制限を廃止いたしました</li>
<li>「望み」編集時、改行した際にカーソルが一番下まで移動する不具合を修正いたしました</li>
<li>起動パスワードを7文字までしか設定できない不具合を修正いたしました</li>
<li>iPhone Xに対応いたしました</li>
</ol>


<h2>主な機能</h2>

<ul>
<li>直感的な操作で美しい「望み」を引き寄せ</li>
<li>豊富なサンプル文から自分好みの「望み」を作成</li>
<li>引き寄せの時間を忘れないようプッシュ通知を設定</li>
<li>アプリ起動時のパスワードロック機能（Touch ID / Face ID対応）</li>
<li>iCloudへのバックアップ機能</li>
</ul>


<h2>価格</h2>

<ul>
<li>無料</li>
</ul>


<h2>対応言語</h2>

<ul>
<li>日本語</li>
<li>英語</li>
</ul>


<h2>公式Facebookページ</h2>

<ul>
<li><a href="https://www.facebook.com/dolice.law.of.attraction">https://www.facebook.com/dolice.law.of.attraction</a></li>
</ul>


<h2>アプリのダウンロード</h2>

<p><a href="https://itunes.apple.com/jp/app/%E6%9C%9B%E3%81%BF%E3%81%8C%E5%8F%B6%E3%81%86-%E5%BC%95%E3%81%8D%E5%AF%84%E3%81%9B%E3%81%AE%E6%B3%95%E5%89%87%E3%82%A2%E3%83%97%E3%83%AA/id841157677?mt=8" style="display:inline-block;overflow:hidden;background:url(//linkmaker.itunes.apple.com/assets/shared/badges/ja-jp/appstore-lrg.svg) no-repeat;width:135px;height:40px;background-size:contain;"></a></p>
]]></content>
  </entry>
  
</feed>
